

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>1.3. Update the PUN Utility &mdash; Open OnDemand 1.1.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="author" title="About these documents"
              href="../about.html"/>
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="Open OnDemand 1.1.0 documentation" href="../index.html"/>
        <link rel="up" title="1. Update Infrastructure" href="update-infrastructure.html"/>
        <link rel="next" title="1.4. Update Mapping Script" href="update-mapping-script.html"/>
        <link rel="prev" title="1.2. Update Proxy Module for Apache" href="update-proxy-module.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Open OnDemand
          

          
          </a>

          
            
            
              <div class="version">
                1.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../about.html">What is Open OnDemand</a></li>
</ul>
<p class="caption"><span class="caption-text">Getting Started</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install-desktops.html">Install Desktops</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install-ihpc-apps.html">Install Other Interactive Apps</a></li>
<li class="toctree-l1"><a class="reference internal" href="../authentication.html">Authentication</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../updating.html">Updating</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="update-infrastructure.html">1. Update Infrastructure</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="update-apache-config.html">1.1. Update Apache Config</a></li>
<li class="toctree-l3"><a class="reference internal" href="update-proxy-module.html">1.2. Update Proxy Module for Apache</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">1.3. Update the PUN Utility</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#do-i-need-to-update">1.3.1. Do I need to update?</a></li>
<li class="toctree-l4"><a class="reference internal" href="#instructions-to-update">1.3.2. Instructions to update</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="update-mapping-script.html">1.4. Update Mapping Script</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="update-apps.html">2. Update Applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="update-desktops.html">3. Update Desktops</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Components</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../infrastructure.html">Infrastructure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../applications.html">Applications</a></li>
</ul>
<p class="caption"><span class="caption-text">Resources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user-documentation.html">User Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../app-development.html">App Development</a></li>
</ul>
<p class="caption"><span class="caption-text">Release Notes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../release-notes/v1.1-release-notes.html">v1.1 Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release-notes/v1.0-release-notes.html">v1.0 Release Notes</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Open OnDemand</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../updating.html">Updating</a> &raquo;</li>
        
          <li><a href="update-infrastructure.html">1. Update Infrastructure</a> &raquo;</li>
        
      <li>1.3. Update the PUN Utility</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/OSC/ood-documentation/blob/release-1.1/source/updating/update-pun-utility.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="update-the-pun-utility">
<span id="update-pun-utility"></span><h1>1.3. Update the PUN Utility<a class="headerlink" href="#update-the-pun-utility" title="Permalink to this headline">¶</a></h1>
<p>The PUN utility is maintained by the <a class="reference internal" href="../infrastructure/nginx-stage.html#nginx-stage"><span class="std std-ref">nginx_stage</span></a> project. Assuming you
previously installed it with <a class="reference internal" href="../installation/install-pun-utility.html#install-pun-utility"><span class="std std-ref">Install the PUN Utility</span></a> you can update it with
the following directions.</p>
<div class="section" id="do-i-need-to-update">
<h2>1.3.1. Do I need to update?<a class="headerlink" href="#do-i-need-to-update" title="Permalink to this headline">¶</a></h2>
<p>Latest version: <code class="docutils literal"><span class="pre">v0.2.1</span></code></p>
<p>You can compare this to the locally installed <a class="reference internal" href="../infrastructure/nginx-stage.html#nginx-stage"><span class="std std-ref">nginx_stage</span></a> with the
following command:</p>
<div class="highlight-sh"><div class="highlight"><pre><span></span>/opt/ood/nginx_stage/sbin/nginx_stage -v
<span class="c1">#=&gt; nginx_stage, version 0.2.1</span>
</pre></div>
</div>
<p>where the version number should be given at the end of the line. If the version
numbers match then you can skip this update.</p>
</div>
<div class="section" id="instructions-to-update">
<h2>1.3.2. Instructions to update<a class="headerlink" href="#instructions-to-update" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p class="first">Fetch the latest changes and check out the latest tag:</p>
<div class="highlight-sh"><div class="highlight"><pre><span></span><span class="nb">cd</span> ~/ood/src/nginx_stage
scl <span class="nb">enable</span> git19 -- git fetch
scl <span class="nb">enable</span> git19 -- git checkout v0.2.1
</pre></div>
</div>
</li>
<li><p class="first">Install it to its global location:</p>
<div class="highlight-sh"><div class="highlight"><pre><span></span>sudo scl <span class="nb">enable</span> rh-ruby22 -- rake install
<span class="c1"># =&gt; mkdir -p /opt/ood/nginx_stage</span>
<span class="c1"># =&gt; cp ...</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>This will not override your previous configuration file located at:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">ood</span><span class="o">/</span><span class="n">nginx_stage</span><span class="o">/</span><span class="n">config</span><span class="o">/</span><span class="n">nginx_stage</span><span class="o">.</span><span class="n">yml</span>
</pre></div>
</div>
<p>as well as the ruby binstub/wrapper script located at:</p>
<div class="last highlight-default"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">ood</span><span class="o">/</span><span class="n">nginx_stage</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">ood_ruby</span>
</pre></div>
</div>
</div>
</li>
<li><p class="first">Clean up app configuration files that point to nonexistant apps:</p>
<div class="highlight-sh"><div class="highlight"><pre><span></span>sudo /opt/ood/nginx_stage/sbin/nginx_stage app_clean
</pre></div>
</div>
</li>
<li><p class="first">Rebuild all the app configuration files in case the template has changed:</p>
<div class="highlight-sh"><div class="highlight"><pre><span></span>sudo /opt/ood/nginx_stage/sbin/nginx_stage app_reset --sub-uri<span class="o">=</span>/pun
</pre></div>
</div>
</li>
<li><p class="first">Shutdown all user PUNs that do not currently have active connections:</p>
<div class="highlight-sh"><div class="highlight"><pre><span></span>sudo /opt/ood/nginx_stage/sbin/nginx_stage nginx_clean
</pre></div>
</div>
<p>This is so that the user configuration files are regenerated when the user’s
PUN starts back up. Any PUNs that do not get shutdown (they had an active
connection) will eventually be shutdown when the user eventually
disconnects due to the cron job.</p>
</li>
</ol>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="update-mapping-script.html" class="btn btn-neutral float-right" title="1.4. Update Mapping Script" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="update-proxy-module.html" class="btn btn-neutral" title="1.2. Update Proxy Module for Apache" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Ohio Supercomputer Center.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>